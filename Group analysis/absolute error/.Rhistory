axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7, width=5) +
geom_line(aes(group = X)) +
geom_point(size = 2) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7, width=0.5) +
geom_line(aes(group = X)) +
geom_point(size = 2) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X)) +
geom_point(size = 2) +
facet_wrap(~ group, width=1) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X)) +
geom_point(size = 2) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X)) +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
# box plot with p value
pwc <- pwc %>% add_xy_position(x = "group")
# box plot with p value
pwc <- pwc %>% add_xy_position(x = "group")
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X)) +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
# box plot with p value
pwc <- pwc %>% add_xy_position(x = "time")
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X)) +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X), colour="grey") +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X), colour="grey") +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
file_list <- list.files(pattern = ".*accuracy.*.csv")
data <- data.frame()
start_end <- data.frame()
rowlength <- data.frame()
for (i in 1:length(file_list)){
I <- read.csv(file_list[i], header = TRUE)
ID <- file_list[i]
Before <- head(I, 15)
After <- tail(I, 15)
Before <- colMeans(Before)
After <- colMeans(After)
ttest <- t.test(Before, After, paried=TRUE)
dataO <- cbind(ID, ttest$statistic, ttest$p.value, ttest$stderr)
data <- rbind.data.frame(data, dataO)
afterO <- cbind(ID, Before, After)
start_end <- rbind.data.frame(start_end, afterO)
rowlength <- rbind(rowlength, nrow(afterO))
}
names(data) <- c("ID", "t-value", "p-value", "Std error")
write.csv(data, "start-endTtest2'.csv")
r55 <- cbind(rep("Trial true", as.numeric(rowlength[5,1])), rep("Trial", as.numeric(rowlength[5,1])), rep("True", as.numeric(rowlength[5,1])), rep("with", as.numeric(rowlength[5,1])))
r44 <- cbind(rep("Trial positive", as.numeric(rowlength[4,1])), rep("Trial", as.numeric(rowlength[4,1])), rep("positive", as.numeric(rowlength[4,1])), rep("with", as.numeric(rowlength[4,1])))
r22 <- cbind(rep("Block true", as.numeric(rowlength[2,1])), rep("Block", as.numeric(rowlength[2,1])), rep("True", as.numeric(rowlength[2,1])), rep("with", as.numeric(rowlength[2,1])))
r11 <- cbind(rep("Block positive", as.numeric(rowlength[1,1])), rep("Block", as.numeric(rowlength[1,1])), rep("positive", as.numeric(rowlength[1,1])), rep("with", as.numeric(rowlength[1,1])))
r33 <- cbind(rep("No feedback", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("without", as.numeric(rowlength[3,1])))
start_end <- start_end[, -1]
dataANOVA <- cbind.data.frame(rbind.data.frame(r11,r22,r33,r44,r55), start_end)
colnames(dataANOVA) <- data.frame("group", "frequency", "content","feedback", "First", "Last")
View(dataANOVA)
write.csv(dataANOVA, "ANOVAmean2.csv")
dataANOVA <- read.csv("ANOVAmean2.csv", header = TRUE)
# orgnize data
dataANOVA <- dataANOVA %>%
gather(key = "time", value = "error", First, Last) %>%
convert_as_factor(group, time)
View(dataANOVA)
# box plot with p value
pwc <- pwc %>% add_xy_position(x = "group")
box.plot <- ggplot(data = dataANOVA, mapping=aes(group, error, colour=factor(time, levels=c("First","Last")))) +
geom_boxplot(size=0.7) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("firebrick", "dodgerblue3")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
box.plot
# paired box plot
pwc <- pwc %>% add_xy_position(x = "time")
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X), colour="grey") +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X), colour="grey") +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("time") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X), colour="grey") +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Time") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X), colour="grey") +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
subtitle = "* Significant at α = 0.05 level",
caption = get_pwc_label(pwc)
) +
xlab("Time") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X), colour="grey") +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
title = "* Significant at α = 0.05 level"
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Time") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X), colour="grey") +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
title = "* Significant at α = 0.05 level",
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Time") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X), colour="grey") +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("dodgerblue3", "firebrick")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = "* Significant at α = 0.05 level" + get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Time") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
View(r11)
setwd("F:/Tools/Rworkspace/FYP-data-analysis/Group analysis/absolute error")
library("ggplot2")
library("BayesFactor")
library("XLConnect")
library("ggpubr")
library("tidyverse")
library("broom")
library("AICcmodavg")
file_list <- list.files(pattern = ".*fit.*.csv")
rowlength <- data.frame()
data <- data.frame()
rate <- vector()
for (i in 1:length(file_list)){
I <- read.csv(file_list[i], header = TRUE)
rate <- I[, 3]
dim(rate) <- c(length(rate), 1)
data <- rbind.data.frame(data, rate)
rowlength <- rbind(rowlength, length(rate))
}
r5 <- cbind(rep("TT", as.numeric(rowlength[5,1])), rep("Trial", as.numeric(rowlength[5,1])), rep("True", as.numeric(rowlength[5,1])), rep("with", as.numeric(rowlength[5,1])))
r4 <- cbind(rep("TP", as.numeric(rowlength[4,1])), rep("Trial", as.numeric(rowlength[4,1])), rep("positive", as.numeric(rowlength[4,1])), rep("with", as.numeric(rowlength[4,1])))
r2 <- cbind(rep("BT", as.numeric(rowlength[2,1])), rep("Block", as.numeric(rowlength[2,1])), rep("True", as.numeric(rowlength[2,1])), rep("with", as.numeric(rowlength[2,1])))
r1 <- cbind(rep("BP", as.numeric(rowlength[1,1])), rep("Block", as.numeric(rowlength[1,1])), rep("positive", as.numeric(rowlength[1,1])), rep("with", as.numeric(rowlength[1,1])))
r3 <- cbind(rep("N", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("without", as.numeric(rowlength[3,1])))
dataANOVA <- cbind.data.frame(rbind.data.frame(r1,r2,r3,r4,r5), data)
colnames(dataANOVA) <- data.frame("group", "frequency", "content","feedback", "learningR")
one.way <- aov(learningR ~ group, data = dataANOVA)
summary(one.way)
dataANOVA %>%
group_by(group) %>%
get_summary_stats(learningR, type = "mean_sd")
setwd("F:/Tools/Rworkspace/FYP-data-analysis/Group analysis/absolute error")
library("ggplot2")
library("BayesFactor")
library("XLConnect")
library("ggpubr")
library("tidyverse")
library("broom")
library("AICcmodavg")
file_list <- list.files(pattern = ".*fit.*.csv")
rowlength <- data.frame()
data <- data.frame()
rate <- vector()
for (i in 1:length(file_list)){
I <- read.csv(file_list[i], header = TRUE)
rate <- I[, 3]
dim(rate) <- c(length(rate), 1)
data <- rbind.data.frame(data, rate)
rowlength <- rbind(rowlength, length(rate))
}
r5 <- cbind(rep("TT", as.numeric(rowlength[5,1])), rep("Trial", as.numeric(rowlength[5,1])), rep("True", as.numeric(rowlength[5,1])), rep("with", as.numeric(rowlength[5,1])))
r4 <- cbind(rep("TP", as.numeric(rowlength[4,1])), rep("Trial", as.numeric(rowlength[4,1])), rep("positive", as.numeric(rowlength[4,1])), rep("with", as.numeric(rowlength[4,1])))
r2 <- cbind(rep("BT", as.numeric(rowlength[2,1])), rep("Block", as.numeric(rowlength[2,1])), rep("True", as.numeric(rowlength[2,1])), rep("with", as.numeric(rowlength[2,1])))
r1 <- cbind(rep("BP", as.numeric(rowlength[1,1])), rep("Block", as.numeric(rowlength[1,1])), rep("positive", as.numeric(rowlength[1,1])), rep("with", as.numeric(rowlength[1,1])))
r3 <- cbind(rep("N", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("without", as.numeric(rowlength[3,1])))
dataANOVA <- cbind.data.frame(rbind.data.frame(r1,r2,r3,r4,r5), data)
colnames(dataANOVA) <- data.frame("group", "frequency", "content","feedback", "learningR")
one.way <- aov(learningR ~ group, data = dataANOVA)
summary(one.way)
one.way2 <- aov(learningR ~ feedback, data = dataANOVA)
summary(one.way2)
interaction <- aov(learningR ~ frequency*content, data = dataANOVA)
summary(interaction)
dataANOVA %>%
group_by(group) %>%
get_summary_stats(learningR, type = "mean_sd")
ggboxplot(dataANOVA, x = "group", y = "learningR")
r5 <- cbind(rep("Trial true", as.numeric(rowlength[5,1])), rep("Trial", as.numeric(rowlength[5,1])), rep("True", as.numeric(rowlength[5,1])), rep("with", as.numeric(rowlength[5,1])))
r4 <- cbind(rep("Trial positive", as.numeric(rowlength[4,1])), rep("Trial", as.numeric(rowlength[4,1])), rep("positive", as.numeric(rowlength[4,1])), rep("with", as.numeric(rowlength[4,1])))
r2 <- cbind(rep("Block true", as.numeric(rowlength[2,1])), rep("Block", as.numeric(rowlength[2,1])), rep("True", as.numeric(rowlength[2,1])), rep("with", as.numeric(rowlength[2,1])))
r1 <- cbind(rep("Block positive", as.numeric(rowlength[1,1])), rep("Block", as.numeric(rowlength[1,1])), rep("positive", as.numeric(rowlength[1,1])), rep("with", as.numeric(rowlength[1,1])))
r3 <- cbind(rep("No feedback", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("without", as.numeric(rowlength[3,1])))
dataANOVA <- cbind.data.frame(rbind.data.frame(r1,r2,r3,r4,r5), data)
colnames(dataANOVA) <- data.frame("group", "frequency", "content","feedback", "learningR")
View(dataANOVA)
ggboxplot(dataANOVA, x = "group", y = "learningR")
setwd("F:/Tools/Rworkspace/FYP-data-analysis/Group analysis/absolute error")
library("ggplot2")
library("BayesFactor")
library("XLConnect")
library("ggpubr")
library("tidyverse")
library("broom")
library("AICcmodavg")
library("rstatix")
library("MBESS")
library("rstatix")
file_list <- list.files(pattern = ".*accuracy.*.csv")
data <- data.frame()
start_end <- data.frame()
rowlength <- data.frame()
for (i in 1:length(file_list)){
I <- read.csv(file_list[i], header = TRUE)
ID <- file_list[i]
Before <- head(I, 15)
After <- tail(I, 15)
Before <- colMeans(Before)
After <- colMeans(After)
ttest <- t.test(Before, After, paried=TRUE)
dataO <- cbind(ID, ttest$statistic, ttest$p.value, ttest$stderr)
data <- rbind.data.frame(data, dataO)
afterO <- cbind(ID, Before, After)
start_end <- rbind.data.frame(start_end, afterO)
rowlength <- rbind(rowlength, nrow(afterO))
}
names(data) <- c("ID", "t-value", "p-value", "Std error")
write.csv(data, "start-endTtest2'.csv")
r55 <- cbind(rep("Trial true", as.numeric(rowlength[5,1])), rep("Trial", as.numeric(rowlength[5,1])), rep("True", as.numeric(rowlength[5,1])), rep("with", as.numeric(rowlength[5,1])))
r44 <- cbind(rep("Trial positive", as.numeric(rowlength[4,1])), rep("Trial", as.numeric(rowlength[4,1])), rep("positive", as.numeric(rowlength[4,1])), rep("with", as.numeric(rowlength[4,1])))
r22 <- cbind(rep("Block true", as.numeric(rowlength[2,1])), rep("Block", as.numeric(rowlength[2,1])), rep("True", as.numeric(rowlength[2,1])), rep("with", as.numeric(rowlength[2,1])))
r11 <- cbind(rep("Block positive", as.numeric(rowlength[1,1])), rep("Block", as.numeric(rowlength[1,1])), rep("positive", as.numeric(rowlength[1,1])), rep("with", as.numeric(rowlength[1,1])))
r33 <- cbind(rep("No feedback", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("without", as.numeric(rowlength[3,1])))
start_end <- start_end[, -1]
dataANOVA <- cbind.data.frame(rbind.data.frame(r11,r22,r33,r44,r55), start_end)
colnames(dataANOVA) <- data.frame("group", "frequency", "content","feedback", "First", "Last")
write.csv(dataANOVA, "ANOVAmean2.csv")
dataANOVA <- read.csv("ANOVAmean2.csv", header = TRUE)
# orgnize data
dataANOVA <- dataANOVA %>%
gather(key = "time", value = "error", First, Last) %>%
convert_as_factor(group, time)
dataANOVA %>%
group_by(group, time) %>%
get_summary_stats(error, type = "mean_sd")
#check assumptions
dataANOVA %>%
group_by(time, group) %>%
identify_outliers(error)
dataANOVA %>%
group_by(time, group) %>%
shapiro_test(error)
ggqqplot(dataANOVA, "error", ggtheme = theme_bw()) +
facet_grid(time ~ group)
one.way <- aov(error ~group, data = dataANOVA)
summary(one.way)
# mixed ANOVA
mixed.aov <- anova_test(
data = dataANOVA, dv = error, wid = X,
between = group, within = time
)
get_anova_table(mixed.aov)
mixed.aov2 <- anova_test(
data = dataANOVA, dv = error, wid = X,
between = frequency, within = time
)
get_anova_table(mixed.aov2)
mixed.aov3 <- anova_test(
data = dataANOVA, dv = error, wid = X,
between = content, within = time
)
get_anova_table(mixed.aov3)
mixed.aov4 <- anova_test(
data = dataANOVA, dv = error, wid = X,
between = feedback, within = time
)
get_anova_table(mixed.aov4)
# post hoc
pwc <- dataANOVA %>%
group_by(group) %>%
pairwise_t_test(error ~ time, p.adjust.method = "bonferroni")
pwc
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X), colour="grey") +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("firebrick", "dodgerblue3")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Time") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
# box plot with p value
pwc <- pwc %>% add_xy_position(x = "group")
box.plot <- ggplot(data = dataANOVA, mapping=aes(group, error, colour=factor(time, levels=c("First","Last")))) +
geom_boxplot(size=0.7) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("firebrick", "dodgerblue3")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Groups") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
box.plot
# paired box plot
pwc <- pwc %>% add_xy_position(x = "time")
ggplot(data = dataANOVA, mapping=aes(reorder(time, -error), error)) +
geom_boxplot(aes(colour=time), size=0.7) +
geom_line(aes(group = X), colour="grey") +
geom_point(aes(colour=time), size = 1) +
facet_wrap(~ group) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black", size=1)) +
scale_colour_manual(values=c("firebrick", "dodgerblue3")) +
stat_pvalue_manual(pwc, tip.length = 0, hide.ns = TRUE) +
labs(
subtitle = get_test_label(mixed.aov, detailed = TRUE),
caption = get_pwc_label(pwc)
) +
xlab("Time") + ylab("Error in adjustment") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13))
