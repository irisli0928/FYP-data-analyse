q()
1+1
y
getwd
getwd()
?regressionBF
source("F:/Tools/Rworkspace/FYP-data-analysis/Group analysis/absolute error/all-in-one.R")
ggplot(datac, aes(x=block, y=block_average, colour=group)) +
geom_errorbar(aes(ymin=block_average-se, ymax=block_average+se), width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd) +
ylab("block error") +
xlim(1,12) +
scale_x_continuous(breaks= seq(1, 12, 2)) +
theme(panel.background = element_rect(fill="grey95", colour="white")) +
scale_colour_manual(values=c("dodgerblue3", "goldenrod", "orchid3", "seagreen4", "firebrick"))
setwd("F:/Tools/Rworkspace/FYP-data-analysis/Group analysis/absolute error")
library("ggplot2")
library("BayesFactor")
library("XLConnect")
library("ggpubr")
library("tidyverse")
library("broom")
library("AICcmodavg")
library("rstatix")
library("MBESS")
file_list <- list.files(pattern = ".*accuracy.*.csv")
data <- data.frame()
start_end <- data.frame()
rowlength <- data.frame()
for (i in 1:length(file_list)){
I <- read.csv(file_list[i], header = TRUE)
ID <- file_list[i]
Before <- head(I, 15)
After <- tail(I, 15)
Before <- colMeans(Before)
After <- colMeans(After)
ttest <- t.test(Before, After)
dataO <- cbind(ID, ttest$statistic, ttest$p.value, ttest$stderr)
data <- rbind.data.frame(data, dataO)
afterO <- cbind(ID, Before, After)
start_end <- rbind.data.frame(start_end, afterO)
rowlength <- rbind(rowlength, nrow(afterO))
}
names(data) <- c("ID", "t-value", "p-value", "Std error")
write.csv(data, "start-endTtest2.csv")
r55 <- cbind(rep("TT", as.numeric(rowlength[5,1])), rep("Trial", as.numeric(rowlength[5,1])), rep("True", as.numeric(rowlength[5,1])), rep("with", as.numeric(rowlength[5,1])))
r44 <- cbind(rep("TP", as.numeric(rowlength[4,1])), rep("Trial", as.numeric(rowlength[4,1])), rep("positive", as.numeric(rowlength[4,1])), rep("with", as.numeric(rowlength[4,1])))
r22 <- cbind(rep("BT", as.numeric(rowlength[2,1])), rep("Block", as.numeric(rowlength[2,1])), rep("True", as.numeric(rowlength[2,1])), rep("with", as.numeric(rowlength[2,1])))
r11 <- cbind(rep("BP", as.numeric(rowlength[1,1])), rep("Block", as.numeric(rowlength[1,1])), rep("positive", as.numeric(rowlength[1,1])), rep("with", as.numeric(rowlength[1,1])))
r33 <- cbind(rep("N", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("without", as.numeric(rowlength[3,1])))
View(start_end)
start_end <- start_end[, -1]
dataANOVA <- cbind.data.frame(rbind.data.frame(r11,r22,r33,r44,r55), start_end)
colnames(dataANOVA) <- data.frame("group", "frequency", "content","feedback", "before", "after")
write.csv(dataANOVA, "ANOVAmean2.csv")
dataANOVA <- read.csv("ANOVAmean2.csv", header = TRUE)
dataANOVA <- dataANOVA %>%
gather(key = "time", value = "error", before, after) %>%
convert_as_factor(group, time)
View(start_end)
View(dataANOVA)
dataANOVA <- cbind.data.frame(rbind.data.frame(r11,r22,r33,r44,r55), start_end)
colnames(dataANOVA) <- data.frame("group", "frequency", "content","feedback", "before", "after")
write.csv(dataANOVA, "ANOVAmean2.csv")
dataANOVA <- read.csv("ANOVAmean2.csv", header = TRUE)
dataANOVA <- dataANOVA %>%
gather(key = "time", value = "error", before, after) %>%
convert_as_factor(group, time)
dataANOVA %>%
group_by(group, time) %>%
get_summary_stats(error, type = "mean_sd")
ggplot(data = dataANOVA) +
geom_boxplot(mapping=aes(group, error, colour=factor(time, levels=c("before","after")))) +
theme(legend.position = "top", panel.background = element_rect(fill = "white", colour = "black")) +
scale_colour_manual(values=c("dodgerblue3", "goldenrod2"))
dataANOVA %>%
group_by(group, time) %>%
get_summary_stats(error, type = "mean_sd")
ggboxplot(dataANOVA, x = "group", y = "error",
color = "time", palette = "jco")
source("F:/Tools/Rworkspace/FYP-data-analysis/Group analysis/absolute error/all-in-one.R")
ggplot(datac, aes(x=block, y=block_average, colour=group)) +
ylab("block error") +
xlim(1,12) +
scale_x_continuous(breaks= seq(1, 12, 2)) +
theme(panel.background = element_rect(fill="grey95", colour="white")) +
scale_colour_manual(values=c("dodgerblue3", "goldenrod", "orchid3", "seagreen4", "firebrick"))
write.csv(data, "plotall.csv")
data <- read.csv("plotall.csv")[, -1]
datac <- summarySE(data, measurevar="block_average", groupvars=c("group","block"))
pd <- position_dodge(0.35) # move them .05 to the left and right
ggplot(datac, aes(x=block, y=block_average, colour=group)) +
geom_line() +
geom_point() +
ylab("block error") +
xlim(1,12) +
scale_x_continuous(breaks= seq(1, 12, 2)) +
theme(panel.background = element_rect(fill="grey95", colour="white")) +
scale_colour_manual(values=c("dodgerblue3", "goldenrod", "orchid3", "seagreen4", "firebrick"))
ggplot(datac, aes(x=block, y=block_average, colour=group)) +
geom_line() +
geom_point() +
ylab("block error") +
xlim(1,12) + ylim(5,20) +
scale_x_continuous(breaks= seq(1, 12, 2)) +
theme(panel.background = element_rect(fill="grey95", colour="white")) +
scale_colour_manual(values=c("dodgerblue3", "goldenrod", "orchid3", "seagreen4", "firebrick"))
ggplot(datac, aes(x=block, y=block_average, colour=group)) +
geom_line() +
geom_point() +
ylab("block error") +
xlim(1,12) + ylim(7.5,20) +
scale_x_continuous(breaks= seq(1, 12, 2)) +
theme(panel.background = element_rect(fill="grey95", colour="white")) +
scale_colour_manual(values=c("dodgerblue3", "goldenrod", "orchid3", "seagreen4", "firebrick"))
ggplot(datac, aes(x=block, y=block_average, colour=group)) +
geom_errorbar(aes(ymin=block_average-se, ymax=block_average+se), width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd) +
ylab("block error") +
xlim(1,12) + ylim(7.5,20) +
scale_x_continuous(breaks= seq(1, 12, 2)) +
theme(panel.background = element_rect(fill="grey95", colour="white")) +
scale_colour_manual(values=c("dodgerblue3", "goldenrod", "orchid3", "seagreen4", "firebrick"))
setwd("F:/Tools/Rworkspace/FYP-data-analysis/Group analysis/absolute error")
library("ggplot2")
library("BayesFactor")
library("XLConnect")
library("ggpubr")
library("tidyverse")
library("broom")
library("AICcmodavg")
library("rstatix")
library("MBESS")
file_list <- list.files(pattern = ".*accuracy.*.csv")
data <- data.frame()
start_end <- data.frame()
rowlength <- data.frame()
for (i in 1:length(file_list)){
I <- read.csv(file_list[i], header = TRUE)
ID <- file_list[i]
Before <- head(I, 15)
After <- tail(I, 15)
Before <- colMeans(Before)
After <- colMeans(After)
ttest <- t.test(Before, After)
dataO <- cbind(ID, ttest$statistic, ttest$p.value, ttest$stderr)
data <- rbind.data.frame(data, dataO)
afterO <- cbind(ID, Before, After)
start_end <- rbind.data.frame(start_end, afterO)
rowlength <- rbind(rowlength, nrow(afterO))
}
names(data) <- c("ID", "t-value", "p-value", "Std error")
write.csv(data, "start-endTtest2.csv")
r55 <- cbind(rep("TT", as.numeric(rowlength[5,1])), rep("Trial", as.numeric(rowlength[5,1])), rep("True", as.numeric(rowlength[5,1])), rep("with", as.numeric(rowlength[5,1])))
r44 <- cbind(rep("TP", as.numeric(rowlength[4,1])), rep("Trial", as.numeric(rowlength[4,1])), rep("positive", as.numeric(rowlength[4,1])), rep("with", as.numeric(rowlength[4,1])))
r22 <- cbind(rep("BT", as.numeric(rowlength[2,1])), rep("Block", as.numeric(rowlength[2,1])), rep("True", as.numeric(rowlength[2,1])), rep("with", as.numeric(rowlength[2,1])))
r11 <- cbind(rep("BP", as.numeric(rowlength[1,1])), rep("Block", as.numeric(rowlength[1,1])), rep("positive", as.numeric(rowlength[1,1])), rep("with", as.numeric(rowlength[1,1])))
r33 <- cbind(rep("N", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("None", as.numeric(rowlength[3,1])), rep("without", as.numeric(rowlength[3,1])))
start_end <- start_end[, -1]
dataANOVA <- cbind.data.frame(rbind.data.frame(r11,r22,r33,r44,r55), start_end)
colnames(dataANOVA) <- data.frame("group", "frequency", "content","feedback", "before", "after")
write.csv(dataANOVA, "ANOVAmean2.csv")
dataANOVA <- read.csv("ANOVAmean2.csv", header = TRUE)
dataANOVA <- dataANOVA %>%
gather(key = "time", value = "error", before, after) %>%
convert_as_factor(group, time)
dataANOVA %>%
group_by(group, time) %>%
get_summary_stats(error, type = "mean_sd")
help(anova_test)
View(dataANOVA)
View(start_end)
View(dataANOVA)
mixed.aov <- anova_test(
data = dataANOVA, dv = error, wid = X,
between = group, within = time
)
get_anova_table(res.aov)
get_anova_table(mixed.aov)
mixed.aov2 <- anova_test(
data = dataANOVA, dv = error, wid = X,
between = frequency, within = time
)
get_anova_table(mixed.aov)
get_anova_table(mixed.aov2)
interaction2 <- aov(error ~ group*time, data = dataANOVA)
summary(interaction2)
mixed.aov3 <- anova_test(
data = dataANOVA, dv = error, wid = X,
between = content, within = time
)
get_anova_table(mixed.aov3)
mixed.aov4 <- anova_test(
data = dataANOVA, dv = error, wid = X,
between = feedback, within = time
)
get_anova_table(mixed.aov4)
sink("meanComparisonANOVA2.txt")
print(dataANOVA %>%
group_by(group, time) %>%
get_summary_stats(error, type = "mean_sd"))
print(dataANOVA %>%
group_by(frequency, time) %>%
get_summary_stats(error, type = "mean_sd"))
print(dataANOVA %>%
group_by(content, time) %>%
get_summary_stats(error, type = "mean_sd"))
print(dataANOVA %>%
group_by(feedback, time) %>%
get_summary_stats(error, type = "mean_sd"))
print(get_anova_table(mixed.aov))
print(get_anova_table(mixed.aov2))
print(get_anova_table(mixed.aov3))
print(get_anova_table(mixed.aov4))
sink()
